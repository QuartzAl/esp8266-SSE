(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(t){if(t.ep)return;t.ep=!0;const n=r(t);fetch(t.href,n)}})();const s=L.map("map").setView([51.5,-.09],15),c=new Map;L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(s);function l(o,e){let r=c.get(o);return r?(r.setLatLng(e),s.setView(r.getLatLng())):(r=L.marker(e).addTo(s),s.setView(r.getLatLng()),c.set(o,r)),r}function u(){if(window.EventSource){var o=new EventSource(d+"/events");o.addEventListener("open",function(e){console.log("Events Connected")},!1),o.addEventListener("error",function(e){e.target.readyState!==EventSource.OPEN&&console.log("Events Disconnected")},!1),o.addEventListener("message",function(e){console.log(e.data);const r=JSON.parse(e.data);l("default",r)},!1)}}const d="";fetch(d+"/data").then(async o=>{const e=(await o.text()).split(",").map(Number.parseFloat);if(e.length!==2)throw new Error("Invalid latlong");l("default",[e[0],e[1]]).bindPopup("<b>Snacks stand</b><br>Status: Broken").openPopup()});u();
