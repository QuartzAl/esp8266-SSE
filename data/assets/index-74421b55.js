(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}})();const c=L.map("map").setView([51.5,-.09],15),i=new Map;L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(c);function d(o,e){let n=i.get(o);return n?n.setLatLng(e):(n=L.marker(e).addTo(c),i.set(o,n)),n}function l(){if(window.EventSource){var o=new EventSource("/events");o.addEventListener("open",function(e){console.log("Events Connected")},!1),o.addEventListener("error",function(e){e.target.readyState!==EventSource.OPEN&&console.log("Events Disconnected")},!1),o.addEventListener("message",function(e){const n=JSON.parse(e.data);d("default",n)},!1)}}fetch("/data").then(async o=>{const e=(await o.text()).split(",").map(Number.parseFloat);if(e.length!==2)throw new Error("Invalid latlong");d("default",[e[0],e[1]]).bindPopup("<b>Snacks stand</b><br>Status: Broken").openPopup()});l();
